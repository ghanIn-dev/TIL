# Sample -3 JOIN

* **가장 오래 근무한 직원 10명의 현재부서의 이름을 출력하시오**

* ```
  SELECT E.EMP_NO, E.FIRST_NAME, D.DEPT_NAME
    FROM DEPT_EMP DE
    INNER JOIN EMPLOYEES E ON E.EMP_NO = DE.EMP_NO
    INNER JOIN DEPARTMENTS D ON D.DEPT_NO = DE.DEPT_NO
  WHERE DE.TO_DATE='9999-01-01'
  ORDER BY HIRE_DATE DESC
  LIMIT 10;
  ```

* **부서별로 직원 수를 구하되 부서 이름이 출력되게 하시오**
  ![](/data:image/png;base64,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)   
* ```
  SELECT DEPT_NAME, COUNT(*)
    FROM DEPT_EMP DE
    INNER JOIN DEPARTMENTS D D.DEPT_NO = DE.DEPT_NO
  WHERE DE.TO_DATE='9999-01-01'
  GROUP BY DEPT_NAME
  ORDER BY COUNT(*)
  ```

  이 경우 서브쿼리를 사용하는 것이 더 효율적일 수 있다. \(서브쿼리는 다음 샘플에서 비교한다.\)
* **급여 평균이 가장 높은 부서 5개를 출력하시오**
  ```
  SELECT DEPT_NO , AVG(SALARY) SA
    FROM DEPT_EMP DE
    INNER JOIN SALARIES SAL ON DE.EMP_NO = SAL.EMP_NO
  WHERE DE.TO_DATE='9999-01-01' AND SAL.TO_DATE='9999-01-01'
  GROUP BY DEPT_NO
  ORDER BY SA DESC
  LIMIT 5
  ```

  from에 어떤 테이블을 선택할건지에 대한 고민을 해야하며, where절에 조건이 2개가 온다는 것 그래야 작업 속도가 향상된다\(비교횟수 감소\)




